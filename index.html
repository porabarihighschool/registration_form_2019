<!DOCTYPE html>
<html lang="en">

<head>

    <!-- Meta settings for character encoding and responsive design -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Google fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Alfa+Slab+One&family=Anton&family=Bree+Serif&family=Cascadia+Code:ital,wght@0,200..700;1,200..700&family=Cascadia+Mono:ital,wght@0,200..700;1,200..700&family=Caveat:wght@400..700&family=Comic+Relief:wght@400;700&family=Coral+Pixels&family=Dancing+Script:wght@400..700&family=Edu+QLD+Beginner:wght@400..700&family=Exo+2:ital,wght@0,100..900;1,100..900&family=Geist+Mono:wght@100..900&family=Hind+Siliguri:wght@300;400;500;600;700&family=IBM+Plex+Serif:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&family=Indie+Flower&family=Josefin+Sans:ital,wght@0,100..700;1,100..700&family=Lilita+One&family=Orbitron:wght@400..900&family=Permanent+Marker&family=Playwrite+DK+Loopet:wght@100..400&family=Righteous&family=Source+Code+Pro:ital,wght@0,200..900;1,200..900&family=Space+Grotesk:wght@300..700&display=swap"
        rel="stylesheet">

    <link rel="icon" type="image/png" sizes="32x32" href="logo.png" />
    <title>ржкрзЛржбрж╝рж╛ржмрж╛ржбрж╝рж┐ ржЙржЪрзНржЪ ржмрж┐ржжрзНржпрж╛рж▓ржпрж╝, рж╕рж┐рж░рж╛ржЬржЧржЮрзНржЬ рзйрзм ржмржЫрж░ ржкрзВрж░рзНрждрж┐ ржЙржкрж▓ржХрзНрж╖рзЗ ржкрзБржирж░рзНржорж┐рж▓ржирзА ржЙрзОрж╕ржм</title>

    <!-- Tailwind CSS CDN for styling -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">

    <style>
        /* Background image and general styling */
        body {
            background-image: url('bg.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            font-family: "Exo 2", "Hind Siliguri", sans-serif;
            font-weight: 400;
            font-style: normal;
            font-optical-sizing: auto;
        }

        /* Smooth fade transition effect */
        .fade {
            transition: all 0.5s ease;
            opacity: 0.85;
        }

        /* Class to hide elements with fade effect */
        .fade-out {
            opacity: 0;
        }

        /* Header lock effect */
        header {
            position: sticky;
            top: 0;
            z-index: 50;
        }

        #mainHeading {
            font-size: 2em;
            text-align: center;
            background-image: url(color0.webp);
            background-position: center;
            color: transparent;
            background-clip: text;
        }

        /* Smoothly moves the announcement from right to left */
        @keyframes marquee {
            0% {
                transform: translateX(100%);
            }

            100% {
                transform: translateX(-100%);
            }
        }

        .animate-marquee {
            animation: marquee 15s linear infinite;
        }

        /* Payment options style */
        #paymentOptions {
            gap: 50px;
        }
    </style>

</head>

<body class="bg-gray-100 text-gray-800">

    <!-- Header section for the event title and language toggle buttons -->
    <header class="bg-blue-700 text-white py-4 text-center fade">

        <h1 id="mainHeading" class="text-3xl font-bold">Reunion Festival Marking The 36 Years Anniversary of Porabari
            High
            School, Sirajganj</h1>
        <p id="organizerInfo" class="text-sm mt-1">ЁЯСе Organized by SSC students from 1989 to 2025</p>

        <div class="mt-2">
            <!-- Language selection buttons -->
            <button onclick="setLanguage('en')" class="bg-white text-blue-600 px-3 py-1 rounded mr-2">English</button>
            <button onclick="setLanguage('bn')" class="bg-white text-blue-600 px-3 py-1 rounded">ржмрж╛ржВрж▓рж╛</button>
        </div>

        <!-- ЁЯФФ Scrolling Deadline Announcement -->
        <div class="mt-3 overflow-hidden relative h-10">
            <div id="deadlineAnnouncement"
                class="absolute whitespace-nowrap animate-marquee text-yellow-200 text-sm font-medium">
                <!-- This content will be updated dynamically via JavaScript -->
            </div>
        </div>

    </header>

    <!-- Registration form container -->
    <div class="max-w-xl mx-auto p-6 mt-10 bg-white rounded-2xl shadow-lg fade">

        <!-- Highlight Bar for How to Make Payment Video -->
        <div class="bg-yellow-100 text-yellow-900 px-4 py-3 text-center shadow-md fade">
            <p id="paymentHelpText" class="text-sm md:text-base font-medium">
                ЁЯТб Confused about payment?
                <a id="paymentHelpLink" href="tutorial.html" target="_parent"
                    class="underline text-blue-800 hover:text-green-800">
                    Watch the Payment Instruction Video
                </a>
            </p>
        </div>
        <br>

        <h1 class="text-2xl font-bold mb-4 text-center">Registration Form ЁЯУЭ</h1>

        <!-- Registration form starts here -->
        <form id="registrationForm">
            <!-- Full Name Input Field -->
            <div class="mb-4">
                <label for="name" class="block mb-1 font-medium">Full Name ЁЯзС<span class="text-red-500">*</span></label>
                <input type="text" id="name" name="name" placeholder="Enter Your Full Name"
                    class="w-full border border-gray-300 p-2 rounded" required>
            </div>

            <!-- Phone Number Input Field with validation -->
            <div class="mb-4">
                <label for="phone" class="block mb-1 font-medium">Phone Number ЁЯУ▒<span
                        class="text-red-500">*</span></label>
                <input type="tel" id="phone" name="phone" placeholder="Enter Your Phone Number" maxlength="11"
                    inputmode="numeric" pattern="01[0-9]{9}" class="w-full border border-gray-300 p-2 rounded"
                    title="Enter a valid 11-digit Bangladeshi phone number"
                    class="w-full border border-gray-300 p-2 rounded" required>
            </div>

            <!-- Email Address Input Field -->
            <div class="mb-4">
                <label for="email" class="block mb-1 font-medium">Email Address ЁЯУз</label>
                <input type="email" placeholder="example@email.com" id="email" name="email"
                    class="w-full border border-gray-300 p-2 rounded">
            </div>

            <!-- SSC Batch Input Field -->
            <div class="mb-4">
                <label for="ssc_batch" class="block mb-1 font-medium">SSC Batch ЁЯОУ<span
                        class="text-red-500">*</span></label>
                <select id="ssc_batch" name="ssc_batch" class="w-full border border-gray-300 p-2 rounded" required>
                    <option value="">Select Batch</option>
                    <!-- Batch options from 2010 to 2025 -->
                    <!-- These will be generated dynamically with JavaScript below -->
                </select>
            </div>

            <!-- Number of Participants Input Field with real-time total update -->
            <div class="mb-4">
                <label for="participants" class="block mb-1 font-medium">Number of Participants ЁЯСитАНЁЯСйтАНЁЯСзтАНЁЯСж<span
                        class="text-red-500">*</span></label>
                <input type="number" placeholder="0" id="participants" name="participants" min="1" max="100"
                    class="w-full border border-gray-300 p-2 rounded" required oninput="updateAmount()">
            </div>

            <!-- T-Shirt Size Dropdown Selection -->
            <div class="mb-4">
                <label for="tshirt_size" class="block mb-1 font-medium">T-Shirt Size ЁЯСХ<span
                        class="text-red-500">*</span></label>
                <select id="tshirt_size" name="tshirt_size" class="w-full border border-gray-300 p-2 rounded" required>
                    <option value="">Select Size</option>
                    <option value="S">S</option>
                    <option value="M">M</option>
                    <option value="L">L</option>
                    <option value="XL">XL</option>
                    <option value="XXL">XXL</option>
                </select>
            </div>

            <!-- Payment Method Logo Selection -->
            <div class="mb-4">
                <label class="block mb-1 font-medium">Payment Method ЁЯТ│<span class="text-red-500">*</span></label>
                <div id="paymentOptions" class="flex gap-6 justify-center items-center">

                    <!-- bKash -->
                    <div id="option-bkash" onclick="selectPayment('bkash')"
                        class="border-2 border-gray-300 rounded-xl p-2 cursor-pointer hover:scale-105 transition-all">
                        <svg xmlns="http://www.w3.org/2000/svg" width="70" viewBox="0 0 122 54">
                            <!-- [your bKash SVG paths here] -->
                            <title>bKash</title>
                            <g fill="#E2136E">
                                <path
                                    d="m82.9 25.9 3.3 14.6 21.5-10.7zM89 3.8 83.2 25l24 3.8zM62.8.6l25.5 3.1-6 21.8zM62.5 4.8h3l8 10.3zM108.4 29.6l-7.5-10.3 12-2.3zM107.2 32.5l.7-2.2-18.7 9.6zM82.4 26.3 86.3 44l-11.6 9.4zM111.8 22.3h7l-5.1-5.1z" />
                            </g>
                            <!-- (continue rest of bKash SVG as before) -->
                            <path fill="#E2136E"
                                d="M5.4 21.2h15.2v2.2H5.2v17.8s-.7-.1-1.1-.1c-.4 0-.9.1-.9.1V21.1c0-5.2 2-8.2 7-8.5 4.5-.3 8 2.3 10.4 3.6v2.6l-.3.1c-.4-1-5.8-5.5-9.3-5.1-3.6.4-5.8 2.9-5.8 6.2 0 0 0 .9.2 1.2z" />
                            <path fill="#E2136E"
                                d="M36.6 24.9c3.8-.1 5.7 1.2 5.8 4.1.1 1.6-.6 3.1-1.7 4.4l-1.9.1v-.3c.7-.2 2.3-1.3 2.2-3.3s-1.6-3.6-4-3.5c0 0-.4 0-.6.1l.2-1.6z" />
                            <path fill="#E2136E" d="M18.5 23h2.1v18.2l-2.1-.7z" />
                            <path fill="#E2136E"
                                d="M57.3 25.5c-.8-2.7-3.1-4.3-4.8-4.3H48v2.2h3c1.3 0 2.6-.1 3.8 1 .5.5.7 1 .9 1.7.4 1.7-.4 3.8-2.4 3.8-.6 0-1.3 0-1.9-.2v.1c.5.6.8 1.4 1.2 2.1 1.2-.2 2.4-.9 3.2-1.7 1.1-1.3 1.8-2.9 1.5-4.7" />
                            <path fill="#E2136E"
                                d="M60.6 21.5c-1.3.2-3.3 1.3-4 4.1-.2 1.8.3 3.4 1.5 4.6.7.8 1.8 1.5 2.8 1.7.3-.7.7-1.4 1.1-2.1l-.1-.1c-.5.2-1.1.2-1.7.2-2.1-.1-2.4-2.2-2.1-3.8.3-1.4 1.5-2.8 2.8-2.9 1.4-.1 3.1 1 3.4 2.5.2.8.2 1.6.2 2.4v13.2s.6-.1 1-.1 1 .1 1 .1V21.4h-2.2v2.2c0-.1.1-.1 0-.3-.7-1.3-2.5-2-3.7-1.8M47.6 21.2v20s-.6-.1-1-.1-1 .1-1 .1V23.4H21.1v-2.2h26.5z" />
                            <path fill="#E2136E"
                                d="M20.6 41.2h-.3c-7.8 0-12.2-4.3-12.2-8.6 0-3.6 3.3-7.8 10.9-7.8l1.3 1c-5.3 0-9.6 3.4-9.6 6.8 0 3 3.8 7.8 9.9 7.8v.8z" />
                            <path fill="#E2136E" d="M34.8 23h2.1v18.2l-2.1-.7z" />
                            <path fill="#E2136E"
                                d="M36.9 41.2h-.3c-7.8 0-12.2-4.3-12.2-8.6 0-3.6 3.3-7.8 10.9-7.8l1.3 1c-5.3 0-9.6 3.4-9.6 6.8 0 3 3.8 7.8 9.9 7.8v.8z" />
                        </svg>
                    </div>

                    <!-- Nagad -->
                    <div id="option-nagad" onclick="selectPayment('nagad')"
                        class="border-2 border-gray-300 rounded-xl p-2 cursor-pointer hover:scale-105 transition-all">
                        <img src="https://nagad.com.bd/_nuxt/img/new-logo.14fe8a5.png" alt="Nagad" title="Nagad"
                            class="w-16">
                    </div>

                    <!-- Rocket -->
                    <div id="option-rocket" onclick="selectPayment('rocket')"
                        class="border-2 border-gray-300 rounded-xl p-2 cursor-pointer hover:scale-105 transition-all">
                        <img src="https://www.dutchbanglabank.com/img/mlogo.png" alt="Rocket" title="Rocket"
                            class="w-16">
                    </div>
                </div>

                <!-- Hidden input to store selected method -->
                <input type="hidden" name="payment_method" id="payment_method" required>
            </div>

            <!-- Payment Details Section for showing instructions -->
            <div id="paymentDetails" class="mt-2 text-sm text-gray-700 hidden border p-2 rounded bg-gray-50"
                aria-live="polite"></div>

            <!-- Copy Payment Number Button -->
            <button id="copyPaymentNumber" class="hidden bg-blue-600 text-white px-3 py-1 rounded mt-2">Copy
                Number ЁЯУЛ</button>

            <!-- Total Amount Display -->
            <div class="mb-4">
                <p id="amount_display" class="text-lg font-semibold">Total: 0 Taka</p>
                <input type="hidden" id="total_amount" name="total_amount" value="0">
            </div>

            <!-- Transaction ID Input Field -->
            <div class="mb-4">
                <label for="transaction_id" class="block mb-1 font-medium">Payment Transaction ID ЁЯФС<span
                        class="text-red-500">*</span></label>
                <input type="text" id="transaction_id" name="transaction_id" placeholder="Enter Your Transaction ID"
                    maxlength="10" pattern=".{10,10}" class="w-full border border-gray-300 p-2 rounded" required>
            </div>

            <!-- Payment Screenshot Upload Field -->
            <div class="mb-6">
                <label for="payment_screenshot" class="block text-gray-700 font-medium mb-2">
                    Payment Screenshot ЁЯУ╕<span class="text-red-500">*</span>
                </label>
                <div
                    class="border-2 border-dashed border-gray-300 rounded-lg p-4 bg-gray-50 hover:bg-gray-100 transition duration-200">
                    <label for="payment_screenshot"
                        class="flex flex-col items-center justify-center cursor-pointer space-y-2">
                        <svg class="w-10 h-10 text-gray-400" fill="none" stroke="currentColor" stroke-width="1.5"
                            viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                d="M3 16.5V19a2.5 2.5 0 002.5 2.5h13a2.5 2.5 0 002.5-2.5v-2.5M16 10l-4-4m0 0L8 10m4-4v12" />
                        </svg>
                        <span class="text-gray-500 text-sm text-center">Click to upload or drag your screenshot here<br>
                            <span class="text-xs text-gray-400">(PNG, JPG only, max 2MB)</span>
                        </span>

                        <!-- Screenshot upload input -->
                        <input type="file" id="payment_screenshot" name="payment_screenshot" accept="image/*"
                            class="hidden" required>

                        <!-- Container for image preview and remove button -->
                        <div id="screenshotContainer" style="display:none; position:relative; width: fit-content;"
                            class="mt-2">
                            <button id="removeScreenshot" type="button"
                                style="position: absolute; top: 2px; right: 2px; background-color: rgba(0, 0, 0, 0.4); color: white; border: none; border-radius: 4px; padding: 1px 2px; cursor: pointer; z-index: 10;">
                                тЬХ
                            </button>
                            <img id="screenshotPreview" src="" alt="Preview"
                                style="max-width: 100px; max-height: 100px; border-radius: 8px;" />
                        </div>
                    </label>
                </div>
            </div>

            <input type="hidden" id="registration_id" name="registration_id" value="">

            <!-- Submit Button with spinner -->
            <div class="flex justify-center">
                <button type="submit" id="submitBtn"
                    class="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 flex justify-center items-center gap-2">
                    <svg id="spinner" class="animate-spin h-5 w-5 text-white hidden" xmlns="http://www.w3.org/2000/svg"
                        fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4">
                        </circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v8H4z"></path>
                    </svg>
                    <span>Submit</span>
                </button>
            </div>

        </form>

        <!-- Contact Information Section -->
        <div class="mt-8 text-center text-sm text-gray-600 fade">
            <p><strong>Address:</strong> Porabari High School School Ground</p>
            <p><strong>Contact:</strong> 01772-659023</p>
        </div>

        <!-- Developer Credit -->
        <div class="mt-4 cursor-not-allowed text-center text-xs text-blue-800 hover:text-green-600 fade">
            <p>Developed by <strong>MD. SOJIB HOSSEN</strong></p>
        </div>

    </div>

    <script>
        // Google Apps Script endpoint for form submissions
        const scriptURL = 'https://script.google.com/macros/s/AKfycbzBSI9MPt4S2xCjdx2NsRkvqtl6fu4jBq0dbVGMVd9psHV7fBRlGQvo88Ld_Hcf2LOO/exec';

        // Language translations
        const translations = {
            en: [
                "Full Name ЁЯзС", "Phone Number ЁЯУ▒", "Email Address ЁЯУз", "SSC Batch ЁЯОУ", "Number of Participants ЁЯСитАНЁЯСйтАНЁЯСзтАНЁЯСж",
                "T-Shirt Size ЁЯСХ", "Payment Method ЁЯТ│", "Payment Transaction ID ЁЯФС", "Payment Screenshot ЁЯУ╕", "Total:",
                "ЁЯУН Address: Porabari High School School Ground", "ЁЯУЮ Contact: 01772-659023",
                "ЁЯСитАНЁЯТ╗ Developed by MD. SOJIB HOSSEN", "Registration Form ЁЯУЭ",
                "Reunion Festival Marking The 36 Years Anniversary of Porabari High School, Sirajganj",
                "ЁЯСе Organized by SSC students from 1989 to 2025", "тП░ Registration Deadline: Please complete your registration and payment by May 15, 2025 to join the 36th Anniversary Reunion Festival of Porabari High School. Late entries will not be accepted.",
                "ЁЯТб Confused about payment?", "Watch the Payment Instruction Video"
            ],
            bn: [
                "ржкрзВрж░рзНржг ржирж╛ржо ЁЯзС", "ржлрзЛржи ржиржорзНржмрж░ ЁЯУ▒", "ржЗржорзЗржЗрж▓ ржарж┐ржХрж╛ржирж╛ ЁЯУз", "ржПрж╕ржПрж╕рж╕рж┐ ржмрзНржпрж╛ржЪ ЁЯОУ", "ржЕржВрж╢ржЧрзНрж░рж╣ржгржХрж╛рж░рзАрж░ рж╕ржВржЦрзНржпрж╛ ЁЯСитАНЁЯСйтАНЁЯСзтАНЁЯСж",
                "ржЯрж┐-рж╢рж╛рж░рзНржЯрзЗрж░ рж╕рж╛ржЗржЬ ЁЯСХ", "ржкрзЗржорзЗржирзНржЯ ржкржжрзНржзрждрж┐ ЁЯТ│", "ржкрзЗржорзЗржирзНржЯ ржЯрзНрж░рж╛ржиржЬрзНржпрж╛ржХрж╢ржи ржЖржЗржбрж┐ ЁЯФС", "ржкрзЗржорзЗржирзНржЯ рж╕рзНржХрзНрж░рж┐ржирж╢ржЯ ЁЯУ╕", "ржорзЛржЯ:",
                "ЁЯУН ржарж┐ржХрж╛ржирж╛: ржкрзЛржбрж╝рж╛ржмрж╛ржбрж╝рзА ржЙржЪрзНржЪ ржмрж┐ржжрзНржпрж╛рж▓ржпрж╝ ржорж╛ржа", "ЁЯУЮ ржпрзЛржЧрж╛ржпрзЛржЧ: рзжрззрзнрзнрзи-рзмрзлрзпрзжрзирзй",
                "ЁЯСитАНЁЯТ╗ ржбрзЗржнрзЗрж▓ржкрж╛рж░ ржорзЛ. рж╕ржЬрж┐ржм рж╣рзЛрж╕рзЗржи", "ржирж┐ржмржирзНржзржи ржлрж░рзНржо ЁЯУЭ",
                "ржкрзЛржбрж╝рж╛ржмрж╛ржбрж╝рж┐ ржЙржЪрзНржЪ ржмрж┐ржжрзНржпрж╛рж▓ржпрж╝, рж╕рж┐рж░рж╛ржЬржЧржЮрзНржЬ рзйрзм ржмржЫрж░ ржкрзВрж░рзНрждрж┐ ржЙржкрж▓ржХрзНрж╖рзЗ ржкрзБржирж░рзНржорж┐рж▓ржирзА ржЙрзОрж╕ржм",
                "ЁЯСе ржЖрзЯрзЛржЬржирзЗ рззрзпрзорзп ржерзЗржХрзЗ рзирзжрзирзл рж╕рж╛рж▓рзЗрж░ ржПрж╕ржПрж╕рж╕рж┐ рж╢рж┐ржХрзНрж╖рж╛рж░рзНржерзАржмрзГржирзНржж", "тП░ ржирж┐ржмржирзНржзржирзЗрж░ рж╢рзЗрж╖ рж╕ржоржпрж╝: ржжржпрж╝рж╛ ржХрж░рзЗ рззрзл ржорзЗ, рзирзжрзирзл рждрж╛рж░рж┐ржЦрзЗрж░ ржоржзрзНржпрзЗ рж░рзЗржЬрж┐рж╕рзНржЯрзНрж░рзЗрж╢ржи ржУ ржкрзЗржорзЗржирзНржЯ рж╕ржорзНржкржирзНржи ржХрж░рзБржиред ржкрзБржирж░рзНржорж┐рж▓ржирзА ржЙрзОрж╕ржмрзЗ ржЕржВрж╢ ржирж┐рждрзЗ рж╕ржоржпрж╝ржорждрзЛ ржирж┐ржмржирзНржзржи ржкрзНрж░ржпрж╝рзЛржЬржиред",
                "ЁЯТб ржкрзЗржорзЗржирзНржЯ ржирж┐ржпрж╝рзЗ ржмрж┐ржнрзНрж░рж╛ржирзНржд?", "ржкрзЗржорзЗржирзНржЯ ржирж┐рж░рзНржжрзЗрж╢ржирж╛ ржнрж┐ржбрж┐ржУ ржжрзЗржЦрзБржи"
            ]
        };

        // Payment instructions
        const paymentInstructions = {
            en: {
                bkash: "bKash Payment Number: 01772659023 (Personal). Please send the exact amount to the exact number and enter your transaction ID & upload your payment screenshot below.",
                nagad: "Nagad Payment Number: 01772659023 (Personal). Please send the exact amount to the exact number and enter your transaction ID & upload your payment screenshot below.",
                rocket: "Rocket Payment Number: 01772659023 (Personal). Please send the exact amount to the exact number and enter your transaction ID & upload your payment screenshot below."
            },
            bn: {
                bkash: "ржмрж┐ржХрж╛рж╢ ржиржорзНржмрж░: рзжрззрзнрзнрзирзмрзлрзпрзжрзирзй (ржкрж╛рж░рзНрж╕рзЛржирж╛рж▓)ред ржЕржирзБржЧрзНрж░рж╣ ржХрж░рзЗ рж╕ржарж┐ржХ ржиржорзНржмрж░рзЗ ржирж┐рж░рзНржзрж╛рж░рж┐ржд ржЯрж╛ржХрж╛ ржкрж╛ржарж┐рзЯрзЗ ржирж┐ржЪрзЗ ржЯрзНрж░рж╛ржиржЬрзНржпрж╛ржХрж╢ржи ржЖржЗржбрж┐ ржУ ржкрзЗржорзЗржирзНржЯ рж╕рзНржХрзНрж░рж┐ржирж╢ржЯ ржжрж┐ржиред",
                nagad: "ржиржЧржж ржиржорзНржмрж░: рзжрззрзнрзнрзирзмрзлрзпрзжрзирзй (ржкрж╛рж░рзНрж╕рзЛржирж╛рж▓)ред ржЕржирзБржЧрзНрж░рж╣ ржХрж░рзЗ рж╕ржарж┐ржХ ржиржорзНржмрж░рзЗ ржирж┐рж░рзНржзрж╛рж░рж┐ржд ржЯрж╛ржХрж╛ ржкрж╛ржарж┐рзЯрзЗ ржирж┐ржЪрзЗ ржЯрзНрж░рж╛ржиржЬрзНржпрж╛ржХрж╢ржи ржЖржЗржбрж┐ ржУ ржкрзЗржорзЗржирзНржЯ рж╕рзНржХрзНрж░рж┐ржирж╢ржЯ ржжрж┐ржиред",
                rocket: "рж░ржХрзЗржЯ ржиржорзНржмрж░: рзжрззрзнрзнрзирзмрзлрзпрзжрзирзй (ржкрж╛рж░рзНрж╕рзЛржирж╛рж▓)ред ржЕржирзБржЧрзНрж░рж╣ ржХрж░рзЗ рж╕ржарж┐ржХ ржиржорзНржмрж░рзЗ ржирж┐рж░рзНржзрж╛рж░рж┐ржд ржЯрж╛ржХрж╛ ржкрж╛ржарж┐рзЯрзЗ ржирж┐ржЪрзЗ ржЯрзНрж░рж╛ржиржЬрзНржпрж╛ржХрж╢ржи ржЖржЗржбрж┐ ржУ ржкрзЗржорзЗржирзНржЯ рж╕рзНржХрзНрж░рж┐ржирж╢ржЯ ржжрж┐ржиред"
            }
        };

        // Payment numbers
        const paymentNumbers = {
            bkash: "01772659023",
            nagad: "01772659023",
            rocket: "01772659023"
        };

        // default to English
        let currentLanguage = 'en';

        // Update total amount
        function updateAmount() {
            const participantsInput = document.getElementById('participants');
            const batchSelect = document.getElementById('ssc_batch');
            const totalAmountInput = document.getElementById('total_amount');
            const amountDisplay = document.getElementById('amount_display');

            if (!participantsInput || !batchSelect || !totalAmountInput || !amountDisplay) return;

            const participants = parseInt(participantsInput.value);
            const batchYear = parseInt(batchSelect.value);

            if (!batchYear || !participants || participants < 1) {
                totalAmountInput.value = 0;
                amountDisplay.innerText = `${translations[currentLanguage][9]} 0 ${currentLanguage === 'bn' ? 'ржЯрж╛ржХрж╛' : 'Taka'}`;
                return;
            }

            let participantAmount = 600;
            if (batchYear >= 1989 && batchYear <= 2010) {
                participantAmount = 1200;
            } else if (batchYear >= 2011 && batchYear <= 2016) {
                participantAmount = 800;
            }

            const guestCount = Math.max(0, participants - 1);
            const guestAmount = 400;
            const totalAmount = participantAmount + guestCount * guestAmount;

            totalAmountInput.value = totalAmount;
            amountDisplay.innerText = `${translations[currentLanguage][9]} ${totalAmount} ${currentLanguage === 'bn' ? 'ржЯрж╛ржХрж╛' : 'Taka'}`;
        }

        // Populate SSC batch years
        function populateBatchYears() {
            const batchSelect = document.getElementById('ssc_batch');
            if (!batchSelect) return;
            for (let year = 2017; year <= 2025; year++) {
                const option = document.createElement('option');
                option.value = year;
                option.text = year;
                batchSelect.appendChild(option);
            }
        }

        // Set language
        function setLanguage(lang) {
            currentLanguage = lang;
            localStorage.setItem('preferredLang', lang);
            document.body.querySelectorAll('.fade').forEach(el => el.classList.add('fade-out'));

            setTimeout(() => {
                const labels = document.querySelectorAll('label.block.font-medium');
                const text = translations[lang];

                labels.forEach((label, index) => {
                    const hasStar = label.querySelector('span.text-red-500');
                    if (hasStar) {
                        label.innerHTML = `${text[index]} <span class="text-red-500">*</span>`;
                    } else {
                        label.innerText = text[index];
                    }
                });

                document.getElementById('amount_display').innerText =
                    `${text[9]} ${document.getElementById('total_amount').value} ${lang === 'bn' ? 'ржЯрж╛ржХрж╛' : 'Taka'}`;

                document.querySelector('.mt-8 p:nth-child(1)').innerHTML = `<strong>${text[10]}</strong>`;
                document.querySelector('.mt-8 p:nth-child(2)').innerHTML = `<strong>${text[11]}</strong>`;
                document.querySelector('.mt-4 p').innerText = text[12];
                document.querySelector('h1.text-2xl').innerText = text[13];
                document.getElementById('mainHeading').innerText = text[14];
                document.getElementById('organizerInfo').innerText = text[15];
                document.getElementById('deadlineAnnouncement').innerText = text[16];
                document.getElementById('paymentHelpText').childNodes[0].nodeValue = translations[lang][17] + ' ';
                document.getElementById('paymentHelpLink').innerText = translations[lang][18];

                const selectedMethod = document.getElementById('payment_method').value;
                if (selectedMethod) {
                    document.getElementById('paymentDetails').innerText = paymentInstructions[lang][selectedMethod];
                    document.getElementById('paymentDetails').classList.remove('hidden');
                }

                document.body.querySelectorAll('.fade').forEach(el => el.classList.remove('fade-out'));
            }, 500);
        }

        document.addEventListener('DOMContentLoaded', function () {
            populateBatchYears();
            updateAmount();

            const participantsInput = document.getElementById('participants');
            const batchSelect = document.getElementById('ssc_batch');

            if (participantsInput) participantsInput.addEventListener('input', updateAmount);
            if (batchSelect) batchSelect.addEventListener('change', updateAmount);

            const savedLang = localStorage.getItem('preferredLang') || 'bn';
            setLanguage(savedLang);
        });

        // Only allow numbers in phone input
        const phoneInput = document.getElementById('phone');
        phoneInput.addEventListener('input', function () {
            this.value = this.value.replace(/[^0-9]/g, '');
            if (this.value.length > 11) this.value = this.value.slice(0, 11);
        });

        phoneInput.addEventListener('blur', function () {
            const isValid = /^01\d{9}$/.test(this.value);
            const msg = currentLanguage === 'bn'
                ? 'ржлрзЛржи ржиржорзНржмрж░ ржЕржмрж╢рзНржпржЗ рзжрзз ржжрж┐рзЯрзЗ рж╢рзБрж░рзБ рж╣рждрзЗ рж╣ржмрзЗ ржПржмржВ рззрзз рж╕ржВржЦрзНржпрж╛рж░ рж╣рждрзЗ рж╣ржмрзЗред'
                : 'Phone number must start with 01 and be exactly 11 digits.';
            this.setCustomValidity(isValid ? '' : msg);
        });

        // Toast notification
        function showToast(message, bgColor = 'bg-green-600') {
            const toast = document.getElementById('toast');
            toast.className = `fixed top-5 left-1/2 transform -translate-x-1/2 ${bgColor} text-white px-4 py-2 rounded shadow-lg z-50`;
            toast.innerText = message;
            toast.classList.remove('hidden');
            setTimeout(() => toast.classList.add('hidden'), 3000);
        }

        // Image preview and removal
        const fileInput = document.getElementById('payment_screenshot');
        const preview = document.getElementById('screenshotPreview');
        const container = document.getElementById('screenshotContainer');
        const removeButton = document.getElementById('removeScreenshot');

        fileInput.addEventListener('change', function (event) {
            const file = event.target.files[0];
            if (file && file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    preview.src = e.target.result;
                    container.style.display = 'block';
                };
                reader.readAsDataURL(file);
            } else {
                container.style.display = 'none';
                preview.src = '';
            }
        });

        removeButton.addEventListener('click', function () {
            fileInput.value = '';
            preview.src = '';
            container.style.display = 'none';
        });

        // Payment method select
        function selectPayment(method) {
            document.getElementById('payment_method').value = method;

            const paymentDetails = document.getElementById('paymentDetails');
            paymentDetails.innerText = paymentInstructions[currentLanguage][method];
            paymentDetails.classList.remove('hidden');

            const copyBtn = document.getElementById('copyPaymentNumber');
            copyBtn.classList.remove('hidden');
            copyBtn.onclick = () => {
                navigator.clipboard.writeText(paymentNumbers[method]);
                showToast(currentLanguage === 'bn' ? "ЁЯУЛ ржкрзЗржорзЗржирзНржЯ ржиржорзНржмрж░ ржХржкрж┐ рж╣ржпрж╝рзЗржЫрзЗ!" : "ЁЯУЛ Payment number copied!");
            };

            // Transaction field settings
            const transactionInput = document.getElementById('transaction_id');
            if (method === 'nagad') {
                transactionInput.setAttribute('maxlength', '8');
                transactionInput.setAttribute('minlength', '8');
                transactionInput.setAttribute('pattern', '^[A-Z0-9]{8}$');
                transactionInput.placeholder = "Enter Your 8 Character Transaction ID";
            } else {
                transactionInput.setAttribute('maxlength', '10');
                transactionInput.setAttribute('minlength', '10');
                transactionInput.setAttribute('pattern', '^[A-Z0-9]{10}$');
                transactionInput.placeholder = "Enter Your 10 Character Transaction ID";
            }

            transactionInput.addEventListener('input', function () {
                this.value = this.value.toUpperCase();
            });

            // Highlight selected border
            ['bkash', 'nagad', 'rocket'].forEach(id => {
                const div = document.getElementById('option-' + id);
                div.classList.toggle('border-blue-600', id === method);
                div.classList.toggle('border-gray-300', id !== method);
            });
        }

        // Handle form submission
        document.getElementById('registrationForm').addEventListener('submit', async function (e) {
            e.preventDefault();
            const form = e.target;
            const spinner = document.getElementById('spinner');
            const submitBtn = document.getElementById('submitBtn');
            const submitText = submitBtn.querySelector('span');

            spinner.classList.remove('hidden');
            submitBtn.setAttribute('aria-disabled', 'true');
            submitText.innerText = currentLanguage === 'bn' ? "тП│ ржЬржорж╛ ржжрж┐ржЪрзНржЫрзЗ..." : "тП│ Submitting...";

            const batchYear = document.getElementById('ssc_batch').value || '0000';
            const uniqueSuffix = Date.now().toString().slice(-4);
            const registrationId = `PHS${batchYear}${uniqueSuffix}`;
            document.getElementById('registration_id').value = registrationId;

            const formData = new FormData(form);
            const file = formData.get('payment_screenshot');
            if (!file || !file.name) {
                showToast(currentLanguage === 'bn'
                    ? "тЭМ ржкрзЗржорзЗржирзНржЯ рж╕рзНржХрзНрж░рж┐ржирж╢ржЯ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржиред"
                    : "тЭМ Please upload a payment screenshot.", 'bg-red-600');
                return resetState();
            }

            try {
                const base64 = await toBase64(file);
                const postData = new URLSearchParams();
                postData.append("name", formData.get('name') || '');
                postData.append("phone", formData.get('phone') || '');
                postData.append("email", formData.get('email') || '');
                postData.append("batch", formData.get('ssc_batch') || '');
                postData.append("participants", formData.get('participants') || '');
                postData.append("tshirt", formData.get('tshirt_size') || '');
                postData.append("paymentMethod", formData.get('payment_method') || '');
                postData.append("transactionId", formData.get('transaction_id') || '');
                postData.append("registrationId", registrationId);
                postData.append("totalAmount", formData.get('total_amount') || '');
                postData.append("screenshotBase64", base64.split(',')[1]);
                postData.append("screenshotName", file.name);
                postData.append("screenshotType", file.type);

                const response = await fetch(scriptURL, {
                    method: 'POST',
                    body: postData
                });

                const result = await response.json();
                if (result.result === 'success') {
                    const slipData = {
                        name: formData.get('name') || '',
                        phone: formData.get('phone') || '',
                        email: formData.get('email') || '',
                        ssc_batch: formData.get('ssc_batch') || '',
                        participants: formData.get('participants') || '',
                        tshirt_size: formData.get('tshirt_size') || '',
                        payment_method: formData.get('payment_method') || '',
                        transaction_id: formData.get('transaction_id') || '',
                        registration_id: registrationId,
                        total_amount: formData.get('total_amount') || ''
                    };

                    localStorage.setItem('registrationSlip', JSON.stringify(slipData));

                    showToast((currentLanguage === 'bn'
                        ? "тЬЕ ржирж┐ржмржирзНржзржи рж╕ржлрж▓ рж╣ржпрж╝рзЗржЫрзЗ! рж░рзЗржЬрж┐рж╕рзНржЯрзНрж░рзЗрж╢ржи ржЖржЗржбрж┐: "
                        : "тЬЕ Registration successful! Registration ID: ") + registrationId);

                    form.reset();
                    document.getElementById('paymentDetails').classList.add('hidden');
                    document.getElementById('amount_display').innerText = currentLanguage === 'bn'
                        ? "ржорзЛржЯ: 0 ржЯрж╛ржХрж╛"
                        : "Total: 0 Taka";

                    window.location.href = 'registration_slip.html';
                } else {
                    throw new Error(result.message || 'Unknown error.');
                }
            } catch (err) {
                console.error("Submission error:", err);
                showToast(currentLanguage === 'bn'
                    ? "тЭМ ржЬржорж╛ ржжрж┐рждрзЗ ржмрзНржпрж░рзНрже рж╣ржпрж╝рзЗржЫрзЗред ржЖржмрж╛рж░ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзБржиред"
                    : "тЭМ Submission failed. Please try again.", 'bg-red-600');
            } finally {
                resetState();
            }

            function resetState() {
                spinner.classList.add('hidden');
                submitBtn.removeAttribute('aria-disabled');
                submitText.innerText = currentLanguage === 'bn' ? "ржЬржорж╛ ржжрж┐ржи" : "Submit";
            }
        });

        function toBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => resolve(reader.result);
                reader.onerror = error => reject(error);
            });
        }

        // Set default language on page load
        window.addEventListener('DOMContentLoaded', () => {
            setLanguage('en');
        });
    </script>

    <!-- Toast notification container: displays temporary feedback messages to users (like success or error alerts) -->
    <div id="toast"
        class="fixed top-5 left-1/2 transform -translate-x-1/2 bg-green-600 text-white px-4 py-2 rounded shadow-lg hidden z-50">
    </div>

</body>

</html>
